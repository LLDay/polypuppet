syntax = 'proto3';

message Profile {
    string username = 1;
    string password = 2;
    string flow     = 3;
    string group    = 4;
    uint32 audience = 5;
    string platform = 6;
    string release  = 7;
    uint64 uuid     = 8;
}

enum TokenAction {
    GET   = 0;
    NEW   = 1;
    CLEAR = 2;
}

enum MessageType {
    UNKNOWN  = 0;
    STOP     = 1;
    AUTOSIGN = 2;
    LOGIN    = 3;
    RESPONSE = 4;
    TOKEN    = 5;
}

message Message {
    MessageType type    = 1;
    Profile profile     = 2;
    TokenAction taction = 3;
    bool ok             = 4;

    string certname     = 5;
    string token        = 6;
    string output       = 7;
}
